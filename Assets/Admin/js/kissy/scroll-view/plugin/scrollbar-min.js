/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Mar 14 15:40
*/
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(g,i,k,l){g=function(c,e){var a,d=e.escapeHtml,j=this.utils.callCommand;a='<div id="ks-scrollbar-arrow-up-';var b=c.resolve(["id"]);a+=d(b);a+='"\n        class="';var b={},f=[],h=c.resolve(["axis"]);f.push(h+"-arrow-up");b.params=f;b=j(this,c,b,"getBaseCssClasses",2);a+=d(b);a+='">\n    <a href="javascript:void(\'up\')">up</a>\n</div>\n<div id="ks-scrollbar-arrow-down-';b=c.resolve(["id"]);a+=d(b);a+='"\n        class="';b={};f=[];
h=c.resolve(["axis"]);f.push(h+"-arrow-down");b.params=f;b=j(this,c,b,"getBaseCssClasses",6);a+=d(b);a+='">\n    <a href="javascript:void(\'down\')">down</a>\n</div>\n<div id="ks-scrollbar-track-';b=c.resolve(["id"]);a+=d(b);a+='"\n     class="';b={};f=[];h=c.resolve(["axis"]);f.push(h+"-track");b.params=f;b=j(this,c,b,"getBaseCssClasses",10);a+=d(b);a+='">\n<div id="ks-scrollbar-drag-';b=c.resolve(["id"]);a+=d(b);a+='"\n     class="';b={};f=[];h=c.resolve(["axis"]);f.push(h+"-drag");b.params=f;b=
j(this,c,b,"getBaseCssClasses",12);a+=d(b);a+='">\n<div class="';b={};f=[];h=c.resolve(["axis"]);f.push(h+"-drag-top");b.params=f;b=j(this,c,b,"getBaseCssClasses",13);a+=d(b);a+='">\n</div>\n<div class="';b={};f=[];h=c.resolve(["axis"]);f.push(h+"-drag-center");b.params=f;b=j(this,c,b,"getBaseCssClasses",15);a+=d(b);a+='">\n</div>\n<div class="';b={};f=[];h=c.resolve(["axis"]);f.push(h+"-drag-bottom");b.params=f;j=j(this,c,b,"getBaseCssClasses",17);a+=d(j);return a+'">\n</div>\n</div>\n</div>'};g.TPL_NAME=
l.name;return g});
KISSY.add("scroll-view/plugin/scrollbar/render",["component/control","./scrollbar-xtpl"],function(g,i){var k=i("component/control"),l=i("./scrollbar-xtpl"),c=g.Feature,e=c.isTransform3dSupported(),c=c.getCssVendorInfo("transform"),a={beforeCreateDom:function(a,b){a.elCls.push(a.prefixCls+"scrollbar-"+a.axis);g.mix(b,{dragEl:"#ks-scrollbar-drag-{id}",downBtn:"#ks-scrollbar-arrow-down-{id}",upBtn:"#ks-scrollbar-arrow-up-{id}",trackEl:"#ks-scrollbar-track-{id}"})},createDom:function(){var a=this.control;
a.$dragEl=a.get("dragEl");a.$trackEl=a.get("trackEl");a.$downBtn=a.get("downBtn");a.$upBtn=a.get("upBtn");a.dragEl=a.$dragEl[0];a.trackEl=a.$trackEl[0];a.downBtn=a.$downBtn[0];a.upBtn=a.$upBtn[0]},_onSetDragHeight:function(a){this.control.dragEl.style.height=a+"px"},_onSetDragWidth:function(a){this.control.dragEl.style.width=a+"px"},_onSetDragLeft:function(a){this.control.dragEl.style.left=a+"px"},_onSetDragTop:function(a){this.control.dragEl.style.top=a+"px"}};if(c){var d=c.propertyName;a._onSetDragLeft=
function(a){this.control.dragEl.style[d]="translateX("+a+"px) translateY("+this.control.get("dragTop")+"px)"+(e?" translateZ(0)":"")};a._onSetDragTop=function(a){this.control.dragEl.style[d]="translateX("+this.control.get("dragLeft")+"px) translateY("+a+"px)"+(e?" translateZ(0)":"")}}return k.getDefaultRender().extend(a,{ATTRS:{contentTpl:{value:l}}})});
KISSY.add("scroll-view/plugin/scrollbar/control",["node","component/control","./render","event/gesture/drag"],function(g,i){function k(a){a.preventDefault()}function l(a){a.stopPropagation();this.startScroll=this.scrollView.get(this.scrollProperty)}function c(a){var b=this.scrollView,c={};c[this.scrollType]=this.startScroll+("pageX"===this.pageXyProperty?a.deltaX:a.deltaY)/this.trackElSize*this.scrollLength;b.scrollToWithBounds(c)}function e(){var a=this.scrollView,b=this.trackEl,c=this.scrollWHProperty,
f=this.whProperty,e=this.clientWHProperty,d=this.dragWHProperty;a.allowScroll[this.scrollType]?(this.scrollLength=a[c],b=this.trackElSize="width"===f?b.offsetWidth:b.offsetHeight,a=a[e]/this.scrollLength,a*=b,this.set(d,a),this.barSize=a,o(this),this.set("visible",!0)):this.set("visible",!1)}function a(a){this.set("disabled",a.newVal)}function d(){this.hideFn&&p(this)}function j(){var a=this.scrollView;a.allowScroll[this.scrollType]&&(m(this),this.set("visible",!0),this.hideFn&&!a.isScrolling&&p(this),
o(this))}function b(a){function b(){var a={};a[e]=c.get(f)+h*d;c.scrollToWithBounds(a)}a.halt();var c=this.scrollView,f=this.scrollProperty,e=this.scrollType,d=c.getScrollStep()[this.scrollType],a=a.target,h=a===this.downBtn||this.$downBtn.contains(a)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(b,100);b()}function f(a){var b=a.target,c=this.$dragEl;if(!(this.dragEl===b||c.contains(b))){var b=this.scrollType,c=this.scrollView,f=Math.max(0,(a[this.pageXyProperty]-this.$trackEl.offset()[b]-
this.barSize/2)/this.trackElSize),e={};e[b]=f*this.scrollLength;c.scrollToWithBounds(e);a.halt()}}function h(){clearInterval(this.mouseInterval)}function o(a){var b=a.scrollType,c=a.scrollView,f=a.dragLTProperty,e=a.dragWHProperty,d=a.trackElSize,h=a.barSize,j=a.scrollLength,g=c.get(a.scrollProperty),i=c.minScroll[b],b=c.maxScroll[b];g>b?(d*=b/j,a.set(e,h-(g-b)),a.set(f,d+h-a.get(e))):g<i?(d*=i/j,a.set(e,h-(i-g)),a.set(f,d)):(a.set(f,g/j*d),a.set(e,h))}function p(a){m(a);a.hideTimer=setTimeout(a.hideFn,
1E3*a.get("hideDelay"))}function m(a){a.hideTimer&&(clearTimeout(a.hideTimer),a.hideTimer=null)}var r=i("node"),s=i("component/control"),t=i("./render"),q=i("event/gesture/drag"),n=r.Gesture;return s.extend({initializer:function(){var a=this.scrollType="x"===this.get("axis")?"left":"top",b=g.ucfirst(a);this.pageXyProperty="left"===a?"pageX":"pageY";a=this.whProperty="left"===a?"width":"height";a=g.ucfirst(a);this.afterScrollChangeEvent="afterScroll"+b+"Change";this.scrollProperty="scroll"+b;this.dragWHProperty=
"drag"+a;this.dragLTProperty="drag"+b;this.clientWHProperty="client"+a;this.scrollWHProperty="scroll"+a;this.scrollView=this.get("scrollView")},_onSetDisabled:function(a){var e=this,d=a?"detach":"on";e.get("autoHide")||(e.$dragEl[d]("dragstart mousedown",k)[d](q.DRAG_START,l,e)[d](q.DRAG,c,e),g.each([e.$downBtn,e.$upBtn],function(a){a[d](n.start,b,e)[d](n.end,h,e)}),e.$trackEl[d](n.start,f,e))},bindUI:function(){var b=this.scrollView;this.get("autoHide")&&(this.hideFn=g.bind(this.hide,this));b.on(this.afterScrollChangeEvent+
".ks-scrollbar",j,this).on("scrollTouchEnd.ks-scrollbar",d,this).on("afterDisabledChange.ks-scrollbar",a,this).on("reflow.ks-scrollbar",e,this)},syncUI:function(){e.call(this)},destructor:function(){this.scrollView.detach(".ks-scrollbar");m(this)}},{ATTRS:{minLength:{value:20},scrollView:{},axis:{view:1},autoHide:{value:g.UA.ios},visible:{valueFn:function(){return!this.get("autoHide")}},hideDelay:{value:0.1},dragWidth:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragHeight:{setter:function(a){var b=
this.get("minLength");return a<b?b:a},view:1},dragLeft:{view:1,value:0},dragTop:{view:1,value:0},dragEl:{},downBtn:{},upBtn:{},trackEl:{},focusable:{value:!1},xrender:{value:t}},xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(g,i){function k(){var e=this.scrollView,a=this.get("minLength"),d=this.get("autoHideX"),g=this.get("autoHideY"),b;!this.scrollBarX&&e.allowScroll.left&&(b={axis:"x",scrollView:e,elBefore:e.$contentEl},void 0!==a&&(b.minLength=a),void 0!==d&&(b.autoHide=d),this.scrollBarX=(new c(b)).render());!this.scrollBarY&&e.allowScroll.top&&(b={axis:"y",scrollView:e,elBefore:e.$contentEl},void 0!==a&&(b.minLength=a),void 0!==g&&(b.autoHide=
g),this.scrollBarY=(new c(b)).render())}var l=i("base"),c=i("./scrollbar/control");return l.extend({pluginId:this.getName(),pluginBindUI:function(c){this.scrollView=c;c.on("reflow",k,this)},pluginDestructor:function(c){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null);c.detach("reflow",k,this)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
