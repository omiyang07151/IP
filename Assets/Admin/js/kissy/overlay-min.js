/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Mar 14 15:40
*/
KISSY.add("overlay/extension/loading",["node"],function(f,g){function a(){}var d=g("node");a.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new d('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){var b=this._loadingExtEl;b&&b.hide()}};return a});
KISSY.add("overlay/extension/mask",["node"],function(f,g){function a(b,a){var e=b.view.getBaseCssClasses("mask"),e=p('<div  style="width:'+(i?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(i?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(i?"absolute":"fixed")+';" class="'+e+" "+a+'">'+(i?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");e.unselectable();e.on("mousedown",function(e){e.preventDefault()});return e}function d(){}function b(e,b){var a=e.get("maskNode"),c=e.view.getBaseCssClasses("mask-hidden");b?a.removeClass(c):a.addClass(c)}function c(e,a,c,l){var o=e.effect||j;b(l,c);if(o!==j){var l=e.duration,e=e.easing,q=c?1:0;a.stop(1,1);a.css("display",c?j:"block");a[o+h[o][q]](l,function(){a.css("display","")},e)}}function e(e){var a=this.get("maskNode");if(e=e.newVal){var b=Number(this.$el.css("z-index"));
isNaN(b)||a.css("z-index",b)}c(this.get("mask"),a,e,this)}var l=f.UA,m=g("node"),i=6===l.ie,p=m.all;d.ATTRS={mask:{value:!1},maskNode:{}};var j="none",h={fade:["Out","In"],slide:["Up","Down"]};d.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",a(this,this.get("visible")?"":this.view.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var a,b;if(b=this.get("mask")){a=this.get("maskNode");if(b.closeOnClick)a.on(m.Gesture.tap,this.close,this);this.on("afterVisibleChange",e)}},
__destructor:function(){var e;(e=this.get("maskNode"))&&e.remove()}};return d});
KISSY.add("overlay/overlay-xtpl",[],function(f,g,a,d){f=function(a,c,e){var l=this,d=c.escapeHtml,c=l.nativeCommands,i=l.utils.callCommand,g=c["if"],f=c.block,c="",h={},k=[];k.push("ks-overlay-closable");h.params=k;h.fn=function(a){var b;b="\n    ";var c={},o=[],q=a.resolve(["closable"]);o.push(q);c.params=o;c.fn=function(a){var e;e='\n        <a href="javascript:void(\'close\')"\n           id="ks-overlay-close-';var b=a.resolve(["id"]);e+=d(b);e+='"\n           class="';var b={},c=[];c.push("close");
b.params=c;b=i(l,a,b,"getBaseCssClasses",5);e+=d(b);e+="\"\n           role='button'>\n            <span class=\"";b={};c=[];c.push("close-x");b.params=c;a=i(l,a,b,"getBaseCssClasses",7);e+=d(a);return e+'">close</span>\n        </a>\n    '};b+=g.call(l,a,c,e);return b+"\n"};c+=f.call(l,a,h,e);c+='\n\n<div id="ks-content-';h=a.resolve(["id"]);c+=d(h);c+='"\n     class="';h={};k=[];k.push("content");h.params=k;h=i(l,a,h,"getBaseCssClasses",13);c+=d(h);c+='">\n    ';h={};k=[];k.push("ks-overlay-content");
h.params=k;h.fn=function(e){var a;a="\n        ";if((e=e.resolve(["content"]))||0===e)a+=e;return a+"\n    "};c+=f.call(l,a,h,e);return c+"\n</div>"};f.TPL_NAME=d.name;return f});
KISSY.add("overlay/overlay-render",["component/container","./overlay-xtpl","component/extension/content-render"],function(f,g){var a=g("component/container"),d=g("./overlay-xtpl"),b=g("component/extension/content-render");return a.getDefaultRender().extend([b],{createDom:function(){this.fillChildrenElsBySelectors({closeBtn:"#ks-overlay-close-{id}"})}},{ATTRS:{contentTpl:{value:d}},HTML_PARSER:{closeBtn:function(a){return a.one("."+this.getBaseCssClass("close"))}}})});
KISSY.add("overlay/extension/overlay-effect",[],function(f){function g(e){var a=e.$el.clone(!0);a.css({visibility:"visible",overflow:"hidden"}).addClass(e.get("prefixCls")+"overlay-ghost");return e.__afterCreateEffectGhost(a)}function a(e,a,b){e.__effectGhost&&e.__effectGhost.stop(1,1);var c=e.$el,d=f.all,j=e.get("effect"),h=d(j.target),d=j.duration,h=f.mix(h.offset(),{width:h.width(),height:h.height()}),k=f.mix(c.offset(),{width:c.width(),height:c.height()}),n=g(e),j=j.easing;n.insertAfter(c);a?
(a=h,h=k):a=k;c.css("visibility","hidden");n.css(a);e.__effectGhost=n;n.animate(h,{duration:d,easing:j,complete:function(){e.__effectGhost=null;n.remove();c.css("visibility","");b()}})}function d(e,b,d){var g=e.$el,f=e.get("effect"),j=f.effect||"none",h=f.target;"none"===j&&!h?d():h?a(e,b,d):(e=f.duration,f=f.easing,h=b?1:0,g.stop(1,1),g.css({visibility:"visible",display:b?"none":"block"}),g[j+c[j][h]](e,function(){g.css({display:"block",visibility:""});d()},f))}function b(){}var c={fade:["Out","In"],
slide:["Up","Down"]};b.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(a){var b=a.effect;"string"===typeof b&&!c[b]&&(a.effect="")}}};b.prototype={__afterCreateEffectGhost:function(a){return a},_onSetVisible:function(a){var b=this;d(b,a,function(){b.fire(a?"show":"hide")})}};return b});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./overlay-render,./extension/overlay-effect".split(","),function(f,g){var a=g("component/container"),d=g("component/extension/shim"),b=g("component/extension/align"),c=g("./extension/loading"),e=g("./extension/mask"),l=g("./overlay-render"),m=g("./extension/overlay-effect"),i={hide:"hide",destroy:"destroy"};return a.extend([d,c,b,e,m],{bindUI:function(){var a=this,
b=a.get("closeBtn");if(b)b.on("click",function(b){a.close();b.preventDefault()})},close:function(){this[i[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,view:1},closeBtn:{view:1},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},visible:{value:false},xrender:{value:l}},xclass:"overlay"})});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(f,g,a,d){f=function(a,c,e){var f=this,m,i=c.escapeHtml,c=f.nativeCommands,p=f.utils;"undefined"!==typeof d&&d.kissy&&(m=d);var j=p.callCommand,h=c.each,k=c.extend,p=c.block,c="",n={},r=[];r.push("./overlay-xtpl");n.params=r;m&&(g("./overlay-xtpl"),n.params[0]=m.resolveByName(n.params[0]));if((m=k.call(f,a,n,e))||0===m)c+=m;c+="\n";m={};k=[];k.push("ks-overlay-content");m.params=k;m.fn=function(a){var b;b='\n    <div class="';var c={},d=[];
d.push("header");c.params=d;c=j(f,a,c,"getBaseCssClasses",3);b=b+i(c);b=b+'"\n         style="\n';var c={},d=[],g=a.resolve(["headerStyle"]);d.push(g);c.params=d;c.fn=function(b){var a;a="\n ";var c=b.resolve(["xindex"]);a=a+i(c);a=a+":";b=b.resolve(["this"]);a=a+i(b);return a+";\n"};b=b+h.call(f,a,c,e);b=b+'\n"\n         id="ks-stdmod-header-';c=a.resolve(["id"]);b=b+i(c);b=b+'">';if((c=a.resolve(["headerContent"]))||c===0)b=b+c;b=b+'</div>\n\n    <div class="';c={};d=[];d.push("body");c.params=
d;c=j(f,a,c,"getBaseCssClasses",11);b=b+i(c);b=b+'"\n         style="\n';c={};d=[];g=a.resolve(["bodyStyle"]);d.push(g);c.params=d;c.fn=function(b){var a;a="\n ";var c=b.resolve(["xindex"]);a=a+i(c);a=a+":";b=b.resolve(["this"]);a=a+i(b);return a+";\n"};b=b+h.call(f,a,c,e);b=b+'\n"\n         id="ks-stdmod-body-';c=a.resolve(["id"]);b=b+i(c);b=b+'">';if((c=a.resolve(["bodyContent"]))||c===0)b=b+c;b=b+'</div>\n\n    <div class="';c={};d=[];d.push("footer");c.params=d;c=j(f,a,c,"getBaseCssClasses",19);
b=b+i(c);b=b+'"\n         style="\n';c={};d=[];g=a.resolve(["footerStyle"]);d.push(g);c.params=d;c.fn=function(a){var b;b="\n ";var c=a.resolve(["xindex"]);b=b+i(c);b=b+":";a=a.resolve(["this"]);b=b+i(a);return b+";\n"};b=b+h.call(f,a,c,e);b=b+'\n"\n         id="ks-stdmod-footer-';c=a.resolve(["id"]);b=b+i(c);b=b+'">';if((a=a.resolve(["footerContent"]))||a===0)b=b+a;return b+'</div>\n    <div tabindex="0"></div>\n'};return c+=p.call(f,a,m,e)};f.TPL_NAME=d.name;return f});
KISSY.add("overlay/dialog-render",["./overlay-render","./dialog-xtpl"],function(f,g){var a=g("./overlay-render"),d=g("./dialog-xtpl");return a.extend({beforeCreateDom:function(b){f.mix(b.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.control.get("id")})},createDom:function(){this.fillChildrenElsBySelectors({header:"#ks-stdmod-header-{id}",body:"#ks-stdmod-body-{id}",footer:"#ks-stdmod-footer-{id}"})},getChildrenContainerEl:function(){return this.control.get("body")},_onSetBodyStyle:function(b){this.control.get("body").css(b)},
_onSetHeaderStyle:function(b){this.control.get("header").css(b)},_onSetFooterStyle:function(b){this.control.get("footer").css(b)},_onSetBodyContent:function(b){var a;a=this.control.get("body");a.html(b)},_onSetHeaderContent:function(b){var a;a=this.control.get("header");a.html(b)},_onSetFooterContent:function(a){var c;c=this.control.get("footer");c.html(a)}},{ATTRS:{contentTpl:{value:d}},HTML_PARSER:{header:function(a){return a.one("."+this.getBaseCssClass("header"))},body:function(a){return a.one("."+
this.getBaseCssClass("body"))},footer:function(a){return a.one("."+this.getBaseCssClass("footer"))},headerContent:function(a){return a.one("."+this.getBaseCssClass("header")).html()},bodyContent:function(a){return a.one("."+this.getBaseCssClass("body")).html()},footerContent:function(a){return(a=a.one("."+this.getBaseCssClass("footer")))&&a.html()}}})});
KISSY.add("overlay/dialog",["./control","./dialog-render","node"],function(f,g){var a=g("./control"),d=g("./dialog-render"),b=g("node"),a=a.extend({__afterCreateEffectGhost:function(a){var b=this.get("body");a.all("."+this.get("prefixCls")+"stdmod-body").css({height:b.height(),width:b.width()}).html("");return a},handleKeyDownInternal:function(a){if(this.get("escapeToClose")&&a.keyCode===b.KeyCode.ESC){if("select"!==a.target.nodeName.toLowerCase()||a.target.disabled)this.close(),a.halt()}else a:if(a.keyCode===
c){var d=this.$el,f=b.all(a.target),g=d.last();if(f.equals(d)&&a.shiftKey)g[0].focus(),a.halt();else if(f.equals(g)&&!a.shiftKey)this.focus(),a.halt();else if(f.equals(d)||d.contains(f))break a;a.halt()}},_onSetVisible:function(a,b){var c=this.el;if(a)this.__lastActive=c.ownerDocument.activeElement,this.focus(),c.setAttribute("aria-hidden","false");else{c.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(d){}}this.callSuper(a,b)}},{ATTRS:{header:{view:1},body:{view:1},
footer:{view:1},bodyStyle:{value:{},view:1},footerStyle:{value:{},view:1},headerStyle:{value:{},view:1},headerContent:{value:"",view:1},bodyContent:{value:"",view:1},footerContent:{value:"",view:1},closable:{value:!0},xrender:{value:d},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),c=b.KeyCode.TAB;return a});
KISSY.add("overlay/popup",["./control"],function(f,g){return g("./control").extend({initializer:function(){var a=this;a.get("trigger")&&("mouse"===a.get("triggerType")?(a._bindTriggerMouse(),a.on("afterRenderUI",function(){a._bindContainerMouse()})):a._bindTriggerClick())},_bindTriggerMouse:function(){var a=this,d=a.get("trigger"),b;a.__mouseEnterPopup=function(c){a._clearHiddenTimer();b=f.later(function(){a._showing(c);b=void 0},1E3*a.get("mouseDelay"))};d.on("mouseenter",a.__mouseEnterPopup);a._mouseLeavePopup=
function(){b&&(b.cancel(),b=void 0);a._setHiddenTimer()};d.on("mouseleave",a._mouseLeavePopup)},_bindContainerMouse:function(){this.$el.on("mouseleave",this._setHiddenTimer,this).on("mouseenter",this._clearHiddenTimer,this)},_setHiddenTimer:function(){var a=this;a._hiddenTimer=f.later(function(){a._hiding()},1E3*a.get("mouseDelay"))},_clearHiddenTimer:function(){this._hiddenTimer&&(this._hiddenTimer.cancel(),this._hiddenTimer=void 0)},_bindTriggerClick:function(){var a=this;a.__clickPopup=function(d){d.preventDefault();
if(a.get("toggle"))a[a.get("visible")?"_hiding":"_showing"](d);else a._showing(d)};a.get("trigger").on("click",a.__clickPopup)},_showing:function(a){this.set("currentTrigger",f.one(a.target));this.show()},_hiding:function(){this.set("currentTrigger",void 0);this.hide()},destructor:function(){var a=this.$el,d=this.get("trigger");d&&(this.__clickPopup&&d.detach("click",this.__clickPopup),this.__mouseEnterPopup&&d.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&d.detach("mouseleave",
this._mouseLeavePopup));a.detach("mouseleave",this._setHiddenTimer,this).detach("mouseenter",this._clearHiddenTimer,this)}},{ATTRS:{trigger:{setter:function(a){return f.all(a)}},triggerType:{value:"click"},currentTrigger:{},mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(f,g){var a=g("overlay/control"),d=g("overlay/dialog"),b=g("overlay/popup");a.Dialog=d;f.Dialog=d;a.Popup=b;return f.Overlay=a});
