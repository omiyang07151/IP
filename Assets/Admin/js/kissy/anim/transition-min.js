/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Mar 14 15:39
*/
KISSY.add("anim/transition",["dom","./base"],function(c,k){function q(d){var a="";c.each(d,function(b,e){a&&(a+=",");a+=e+" "+b.duration+"s "+b.easing+" "+b.delay+"s"});return a}function r(d,a){var b=1,e=a.propertyName,f=d._propsData;f[e]&&1!==f[e].pos&&(f[e].pos=1,c.each(f,function(a){if(1!==a.pos)return b=0,!1}),b&&d.stop(!0))}function l(d,a,b){c.each(s,function(e){d[b?"removeEventListener":"addEventListener"](e,a,!1)})}function t(d){return d.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}
function h(d,a,b,e,f){var g=this;if(!(g instanceof h))return new h(d,a,b,e,f);h.superclass.constructor.apply(g,arguments);g._onTransitionEnd=function(a){r(g,a)}}var i=k("dom"),m=k("./base"),n=c.Feature.getCssVendorInfo,o=n("transition"),p=o.propertyNamePrefix,s=p?[p.toLowerCase()+"TransitionEnd"]:["transitionend","webkitTransitionEnd"],j=o.propertyName,u={ease:1,linear:1,"ease-in":1,"ease-out":1,"ease-in-out":1};c.extend(h,m,{prepareFx:function(){var d=this._propsData,a={},b,e;for(e in d)b=d[e],"string"===
typeof b.easing?!c.startsWith(b.easing,"cubic-bezier")&&!u[b.easing]&&(b.easing="ease-in"):b.easing="ease-in",b=n(e),a[t(b.propertyName)]=d[e];this._propsData=a},doStart:function(){var d=this,a=d.node,b=a.style,e=d._propsData,f=b[j],g={};c.each(e,function(e,b){var f=e.value,c=i.css(a,b);i.css(a,b,c);"number"===typeof f&&(c=parseFloat(c));c===f&&setTimeout(function(){d._onTransitionEnd({propertyName:b})},0);g[b]=f});-1!==f.indexOf("none")?f="":f&&(f+=",");b[j]=f+q(e);l(a,d._onTransitionEnd);setTimeout(function(){i.css(a,
g)},0)},beforeResume:function(){var d=this._propsData,a=c.merge(d),b=this._runTime/1E3;c.each(a,function(a,f){var c=b;a.delay>=c?a.delay-=c:(c-=a.delay,a.delay=0,a.duration>=c?a.duration-=c:delete d[f])})},doStop:function(d){var a=this.node,b=a.style,e=this._propsData,f=[],g={};l(a,this._onTransitionEnd,1);c.each(e,function(b,c){d||(g[c]=i.css(a,c));f.push(c)});e=c.trim(b[j].replace(RegExp("(^|,)\\s*(?:"+f.join("|")+")\\s+[^,]+","gi"),"$1")).replace(/^,|,,|,$/g,"")||"none";b[j]=e;i.css(a,g)}});c.mix(h,
m.Statics);return h});
