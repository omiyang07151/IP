/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Mar 13 18:01
*/
KISSY.add("menubutton/menubutton-xtpl",["component/extension/content-xtpl"],function(e,g,i,h){e=function(e,j,f){var d,a,j=j.escapeHtml;d=this.nativeCommands;var c=this.utils;"undefined"!==typeof h&&h.kissy&&(a=h);var c=c.callCommand,k=d.include;d="";var b={},m=[];m.push("component/extension/content-xtpl");b.params=m;a&&(g("component/extension/content-xtpl"),b.params[0]=a.resolveByName(b.params[0]));if((f=k.call(this,e,b,f))||0===f)d+=f;d+='\n<div class="';f={};a=[];a.push("dropdown");f.params=a;f=
c(this,e,f,"getBaseCssClasses",2);d+=j(f);d+='">\n    <div class="';f={};a=[];a.push("dropdown-inner");f.params=a;e=c(this,e,f,"getBaseCssClasses",3);d+=j(e);return d+'">\n    </div>\n</div>'};e.TPL_NAME=h.name;return e});
KISSY.add("menubutton/render",["button","./menubutton-xtpl","component/extension/content-render"],function(e,g){var i=g("button"),h=g("./menubutton-xtpl"),l=g("component/extension/content-render");return i.getDefaultRender().extend([l],{decorateDom:function(e){var f=this.control,d=f.get("prefixCls"),e=e.one("."+d+"popupmenu"),a=e[0].ownerDocument.body;a.insertBefore(e[0],a.firstChild);a=this.getComponentConstructorByNode(d,e);f.setInternal("menu",new a({srcNode:e,prefixCls:d}))},beforeCreateDom:function(g){e.mix(g.elAttrs,
{"aria-expanded":!1,"aria-haspopup":!0})},_onSetCollapsed:function(e){var f=this.$el,d=this.getBaseCssClass("open");f[e?"removeClass":"addClass"](d).attr("aria-expanded",!e)}},{ATTRS:{contentTpl:{value:h}}})});
KISSY.add("menubutton/control",["node","button","./render"],function(e,g){function i(a){a.target.isMenuItem&&this.get("collapseOnClick")&&this.set("collapsed",!0)}function h(a){a.target.isMenu&&(a=a.newVal,this.el.setAttribute("aria-activedescendant",a&&a.el.id||""))}var l=g("node"),j=g("button"),f=g("./render"),d=l.KeyCode;return j.extend({isMenuButton:1,_onSetCollapsed:function(a){var c=this.get("menu");if(a)c.hide();else if(a=this.$el,!c.get("visible")){var k={node:a,points:["bl","tl"],overflow:{adjustX:1,
adjustY:1}};e.mix(c.get("align"),k,!1);this.get("matchElWidth")&&(c.render(),k=c.get("el"),k=(parseInt(k.css("borderLeftWidth"),10)||0)+(parseInt(k.css("borderRightWidth"),10)||0),c.set("width",c.get("align").node[0].offsetWidth-k));c.show();a.attr("aria-haspopup",c.get("el").attr("id"))}},bindUI:function(){this.on("afterHighlightedItemChange",h,this);this.on("click",i,this)},handleKeyDownInternal:function(a){var c=a.keyCode,k=""+a.type,b=this.get("menu");if(c===d.SPACE){if(a.preventDefault(),"keyup"!==
k)return}else if("keydown"!==k)return;if(b.get("rendered")&&b.get("visible"))return a=b.handleKeyDownInternal(a),c===d.ESC?(this.set("collapsed",!0),!0):a;if(c===d.SPACE||c===d.DOWN||c===d.UP)return this.set("collapsed",!1),!0},handleClickInternal:function(){this.set("collapsed",!this.get("collapsed"))},handleBlurInternal:function(a){this.callSuper(a);this.set("collapsed",!0)},addItem:function(a,c){this.get("menu").addChild(a,c)},removeItem:function(a,c){this.get("menu").removeChild(a,c)},removeItems:function(a){var c=
this.get("menu");c&&(c.removeChildren?c.removeChildren(a):c.children&&(c.children=[]))},getItemAt:function(a){var c=this.get("menu");return c.get("rendered")&&c.getChildAt(a)},_onSetDisabled:function(a){a||this.set("collapsed",!0)},destructor:function(){this.get("menu").destroy()}},{ATTRS:{matchElWidth:{value:!0},collapseOnClick:{value:!1},menu:{value:{},getter:function(a){a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){a.isControl&&
a.setInternal("parent",this)}},collapsed:{value:!1,view:1},xrender:{value:f}},xclass:"menu-button"})});
KISSY.add("menubutton/select",["node","./control"],function(e,g){function i(a){var b=a.get("menu"),b=b.children||b.get&&b.get("children")||[],a=a.get("value"),c,e;for(e=0;e<b.length;e++)if(c=b[e],h(c)===a)return c;return null}function h(a){var b;if(a)if(a.get){if(void 0===(b=a.get("value")))b=a.get("textContent")||a.get("content")}else if(void 0===(b=a.value))b=a.textContent||a.content;return b}function l(a){var b=a.get("menu"),c=a.get("value"),a=b&&b.get&&b.get("children");e.each(a,function(a){a&&
a.set&&a.set("selected",h(a)===c)})}function j(a){var b=i(this),c=this.get("menu");a.target===c&&((a=b||c.getChildAt(0))&&a.set("highlighted",!0),b&&b.set("selected",!0))}function f(a){var b=i(a),c=b&&(b.textContent||b.get&&b.get("textContent")),b=b&&(b.content||b.get&&b.get("content"));a.set("content",c||b||a.get("defaultCaption"))}function d(a){a=a.target;if(a.isMenuItem){var a=h(a),b=this.get("value");this.set("value",a);a!==b&&this.fire("change",{prevVal:b,newVal:a})}}var a=g("node"),c=g("./control").extend({bindUI:function(){this.on("click",
d,this);this.on("show",j,this)},removeItems:function(){this.callSuper.apply(this,arguments);this.set("value",null)},removeItem:function(a,b){this.callSuper(a,b);a.get("value")===this.get("value")&&this.set("value",null)},_onSetValue:function(){l(this);f(this)},_onSetDefaultCaption:function(){f(this)}},{ATTRS:{value:{},defaultCaption:{value:""},collapseOnClick:{value:!0}},decorate:function(d,b){d=e.one(d);b=b||{};b.elBefore=d;var f,g=[],h,i=null,j=d.val();d.all("option").each(function(a){var b={xclass:"option",
content:a.text(),elCls:a.attr("class"),value:a.val()};j===a.val()&&(i={content:b.content,value:b.value});g.push(b)});e.mix(b,{menu:e.mix({children:g},b.menuCfg)});delete b.menuCfg;h=(new c(e.mix(b,i))).render();if(f=d.attr("name")){var l=(new a('<input type="hidden" name="'+f+'" value="'+j+'">')).insertBefore(d,void 0);h.on("afterValueChange",function(a){l.val(a.newVal||"")})}d.remove();return h},xclass:"select"});return c});
KISSY.add("menubutton/option",["menu"],function(e,g){return g("menu").Item.extend({},{ATTRS:{selectable:{value:!0},textContent:{}},xclass:"option"})});KISSY.add("menubutton",["menubutton/control","menubutton/select","menubutton/option"],function(e,g){var i=g("menubutton/control"),h=g("menubutton/select"),l=g("menubutton/option");i.Select=h;i.Option=l;return i});
