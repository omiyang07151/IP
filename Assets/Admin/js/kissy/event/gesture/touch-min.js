/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Mar 14 15:42
*/
KISSY.add("event/gesture/touch/double-touch",["dom","event/gesture/base"],function(b,c){function g(){}var e=c("dom"),h=c("event/gesture/base").Touch;b.extend(g,h,{requiredTouchCount:2,getCommonTarget:function(b){var a=b.touches,b=a[0].target,a=a[1].target;if(b===a||e.contains(b,a))return b;for(;;){if(e.contains(a,b))return a;a=a.parentNode}}});return g});
KISSY.add("event/gesture/touch/pinch",["event/gesture/base","event/dom/base","./double-touch"],function(b,c){function g(){}function e(a){2===a.targetTouches.length&&a.preventDefault()}var h=c("event/gesture/base").addEvent,i=c("event/dom/base"),a=c("./double-touch");b.extend(g,a,{requiredGestureType:"touch",move:function(a){g.superclass.move.apply(this,arguments);var j=this.lastTouches;if(0<j[0].pageX&&0<j[0].pageY&&0<j[1].pageX&&0<j[1].pageY){var f;f=j[0];var d=j[1],j=f.pageX-d.pageX;f=f.pageY-d.pageY;
f=Math.sqrt(j*j+f*f);this.isStarted?i.fire(this.target,"pinch",b.mix(a,{distance:f,scale:f/this.startDistance})):(this.isStarted=!0,this.startDistance=f,j=this.target=this.getCommonTarget(a),i.fire(j,"pinchStart",b.mix(a,{distance:f,scale:1})))}},end:function(a){g.superclass.end.apply(this,arguments);i.fire(this.target,"pinchEnd",b.mix(a,{touches:this.lastTouches}))}});a=new g;h(["pinchStart","pinchEnd"],{handle:a});a={handle:a};b.Feature.isTouchEventSupported()&&(a.setup=function(){this.addEventListener("touchmove",
e,!1)},a.tearDown=function(){this.removeEventListener("touchmove",e,!1)});h("pinch",a);return{PINCH:"pinch",PINCH_START:"pinchStart",PINCH_END:"pinchEnd"}});
KISSY.add("event/gesture/touch/rotate",["event/gesture/base","event/dom/base","./double-touch"],function(b,c){function g(){}function e(a){2===a.targetTouches.length&&a.preventDefault()}var h=c("event/gesture/base").addEvent,i=c("event/dom/base"),a=c("./double-touch"),k=180/Math.PI;b.extend(g,a,{requiredGestureType:"touch",move:function(a){g.superclass.move.apply(this,arguments);var f=this.lastTouches,d=f[0],c=f[1],f=this.lastAngle,d=Math.atan2(c.pageY-d.pageY,c.pageX-d.pageX)*k;if(void 0!==f){var c=
Math.abs(d-f),e=(d+360)%360,h=(d-360)%360;Math.abs(e-f)<c?d=e:Math.abs(h-f)<c&&(d=h)}this.lastAngle=d;this.isStarted?i.fire(this.target,"rotate",b.mix(a,{angle:d,rotation:d-this.startAngle})):(this.isStarted=!0,this.startAngle=d,this.target=this.getCommonTarget(a),i.fire(this.target,"rotateStart",b.mix(a,{angle:d,rotation:0})))},end:function(a){g.superclass.end.apply(this,arguments);this.lastAngle=void 0;i.fire(this.target,"rotateEnd",b.mix(a,{touches:this.lastTouches}))}});a=new g;h(["rotateEnd",
"rotateStart"],{handle:a});a={handle:a};b.Feature.isTouchEventSupported()&&(a.setup=function(){this.addEventListener("touchmove",e,!1)},a.tearDown=function(){this.removeEventListener("touchmove",e,!1)});h("rotate",a);return{ROTATE_START:"rotateStart",ROTATE:"rotate",ROTATE_END:"rotateEnd"}});
KISSY.add("event/gesture/touch/swipe",["event/gesture/base","event/dom/base"],function(b,c){function g(d,b,c){var e=d.lastTouches[0],g=e.pageX-d.startX,h=e.pageY-d.startY,i=Math.abs(g),l=Math.abs(h);if(c){if(d.isVertical&&d.isHorizontal){if(5>Math.max(i,l))return;l>i?d.isHorizontal=0:d.isVertical=0}}else if(d.isVertical&&l<f&&(d.isVertical=0),d.isHorizontal&&i<f)d.isHorizontal=0;if(d.isHorizontal)g=0>g?"left":"right";else if(d.isVertical)g=0>h?"up":"down",i=l;else return!1;a.fire(e.target,c?j:k,{originalEvent:b.originalEvent,
pageX:e.pageX,pageY:e.pageY,which:1,touch:e,direction:g,distance:i,duration:(b.timeStamp-d.startTime)/1E3})}function e(){}var h=c("event/gesture/base"),i=h.addEvent,a=c("event/dom/base"),k="swipe",j="swiping",f=50;b.extend(e,h.SingleTouch,{requiredGestureType:"touch",start:function(){e.superclass.start.apply(this,arguments);this.isStarted=!0;var a=this.lastTouches[0];this.isVertical=this.isHorizontal=1;this.startX=a.pageX;this.startY=a.pageY},move:function(a){var b=a.timeStamp;e.superclass.move.apply(this,
arguments);if(1E3<b-this.startTime)return!1;var c=this.lastTouches[0],b=c.pageY-this.startY,c=Math.abs(c.pageX-this.startX),b=Math.abs(b);this.isVertical&&35<c&&(this.isVertical=0);this.isHorizontal&&35<b&&(this.isHorizontal=0);return g(this,a,1)},end:function(a){return!1===this.move(a)?!1:g(this,a,0)}});i([k,j],{handle:new e});return{SWIPE:k,SWIPING:j}});
KISSY.add("event/gesture/touch",["./touch/pinch","./touch/rotate","./touch/swipe"],function(b,c){return b.merge(c("./touch/pinch"),c("./touch/rotate"),c("./touch/swipe"))});
